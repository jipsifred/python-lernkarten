<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meine Lernkarten</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .fira-code { font-family: 'Fira Code', monospace; }
        /* Versteckt den Datencontainer, damit er nicht auf der Seite erscheint */
        #data-storage { display: none; }
    </style>
</head>
<body class="bg-gray-900 text-white flex flex-col md:flex-row h-screen antialiased">

<!-- =============================================================================== -->
<!-- ANLEITUNG: So f√ºgst du neue Kapitel und Karten hinzu:
    
    1. √ñffne diese HTML-Datei in einem Text-Editor (z.B. Notepad, VS Code, etc.).
    2. Scrolle nach unten zum Abschnitt "HIER DEINE KAPITEL UND KARTEN EINF√úGEN".
    3. Folge den Beispielen dort.

    UM EIN NEUES KAPITEL HINZUZUF√úGEN:
    Kopiere den kompletten Block von `<div class="chapter-container" ...>` bis zum schlie√üenden `</div>` 
    und √§ndere den Namen in `data-chapter-name="..."`.

    UM EINE NEUE KARTEIKARTE HINZUZUF√úGEN:
    Kopiere innerhalb eines Kapitels den Block `<div class="flashcard">...</div>` 
    und √§ndere den Text in den divs "question" und "answer".

    4. Speichere die Datei und √∂ffne sie in deinem Webbrowser. Fertig!
-->
<!-- =============================================================================== -->


<!-- DATEN-CONTAINER: Hier werden alle Lerninhalte direkt als HTML geschrieben -->
<div id="data-storage">

    <!-- =========== HIER DEINE KAPITEL UND KARTEN EINF√úGEN =========== -->

    <div class="chapter-container" data-chapter-name="Python Grundlagen">
    
        <div class="flashcard">
            <div class="question">Speichere die Ganzzahl 42 in einer Variable namens `a`.</div>
            <div class="answer fira-code">a = 42</div>
        </div>
    
        <div class="flashcard">
            <div class="question">Gegeben sind die Variablen `x` und `y`. Berechne ihre Differenz (x - y) und speichere sie in `ergebnis`.</div>
            <div class="answer fira-code">ergebnis = x - y</div>
        </div>
    
        <div class="flashcard">
            <div class="question">Wandle den String "3.14" in eine Gleitkommazahl um und speichere sie in der Variable `pi_wert`.</div>
            <div class="answer fira-code">pi_wert = float("3.14")</div>
        </div>
    
        <div class="flashcard">
            <div class="question">Pr√ºfe, ob die Variable `a` gleich der Variable `b` ist. Speichere das Ergebnis (True/False) in `sind_gleich`.</div>
            <div class="answer fira-code">sind_gleich = (a == b)</div>
        </div>
    
        <div class="flashcard">
            <div class="question">Ermittle die L√§nge des Strings in der Variable `text` und speichere sie in `laenge`.</div>
            <div class="answer fira-code">laenge = len(text)</div>
        </div>
    
        <div class="flashcard">
            <div class="question">Wandle den gesamten String in der Variable `mein_string` in Gro√übuchstaben um und speichere das Ergebnis in `output`.</div>
            <div class="answer fira-code">output = mein_string.upper()</div>
        </div>
    
        <div class="flashcard">
            <div class="question">Teile den String `csv_daten` bei jedem Komma und speichere die resultierende Liste in `daten_liste`.</div>
            <div class="answer fira-code">daten_liste = csv_daten.split(',')</div>
        </div>
    
        <div class="flashcard">
            <div class="question">Wenn die Variable `alter` gr√∂√üer oder gleich 18 ist, gib "Vollj√§hrig" aus.</div>
            <div class="answer fira-code">if alter >= 18:
        print("Vollj√§hrig")</div>
        </div>
    
        <div class="flashcard">
            <div class="question">Wenn `wert` kleiner als 10 ist, gib "klein" aus, ansonsten gib "gro√ü" aus.</div>
            <div class="answer fira-code">if wert < 10:
        print("klein")
    else:
        print("gro√ü")</div>
        </div>
    
        <div class="flashcard">
            <div class="question">Iteriere mit einer `for`-Schleife √ºber die Liste `elemente` und gib jedes Element aus.</div>
            <div class="answer fira-code">for item in elemente:
        print(item)</div>
        </div>
    
        <div class="flashcard">
            <div class="question">Nutze eine `while`-Schleife, um die Variable `zaehler` von 1 auf 5 zu erh√∂hen und bei jeder Iteration den Wert auszugeben.</div>
            <div class="answer fira-code">zaehler = 1
    while zaehler <= 5:
        print(zaehler)
        zaehler += 1</div>
        </div>
    
        <div class="flashcard">
            <div class="question">F√ºge das Element "Apfel" am Ende der Liste `obst` hinzu.</div>
            <div class="answer fira-code">obst.append("Apfel")</div>
        </div>
    
        <div class="flashcard">
            <div class="question">Greife auf das erste Element der Liste `daten` zu und speichere es in `erstes_element`.</div>
            <div class="answer fira-code">erstes_element = daten[0]</div>
        </div>
        
        <div class="flashcard">
            <div class="question">Entferne das letzte Element aus der Liste `meine_liste`.</div>
            <div class="answer fira-code">meine_liste.pop()</div>
        </div>
    
        <div class="flashcard">
            <div class="question">Sortiere die Liste `zahlen` in aufsteigender Reihenfolge.</div>
            <div class="answer fira-code">zahlen.sort()</div>
        </div>
    
        <div class="flashcard">
            <div class="question">Erstelle ein Dictionary `auto` mit dem Schl√ºssel "marke" und dem Wert "BMW".</div>
            <div class="answer fira-code">auto = {"marke": "BMW"}</div>
        </div>
        
        <div class="flashcard">
            <div class="question">F√ºge dem Dictionary `person` den Schl√ºssel "alter" mit dem Wert 30 hinzu.</div>
            <div class="answer fira-code">person["alter"] = 30</div>
        </div>
        
        <div class="flashcard">
            <div class="question">Greife auf den Wert des Schl√ºssels "stadt" im Dictionary `adresse` zu und speichere ihn in `wohnort`.</div>
            <div class="answer fira-code">wohnort = adresse["stadt"]</div>
        </div>
    
        <div class="flashcard">
            <div class="question">Erstelle ein Set `einzigartige_werte` aus der Liste `werte_mit_duplikaten`.</div>
            <div class="answer fira-code">einzigartige_werte = set(werte_mit_duplikaten)</div>
        </div>
        
        <div class="flashcard">
            <div class="question">Gegeben sind die Sets `set1` und `set2`. Bilde die Vereinigung der beiden und speichere sie in `ergebnis_set`.</div>
            <div class="answer fira-code">ergebnis_set = set1.union(set2)</div>
        </div>
    
    </div>

    <div class="chapter-container" data-chapter-name="Schleifen und Listen">
        
        <div class="flashcard">
            <div class="question">Erstelle eine Liste von Zahlen von 1 bis 3 und gib jedes Element mit einer for-Schleife aus.</div>
            <div class="answer fira-code">my_list = [1, 2, 3]
for number in my_list:
    print(number)</div>
        </div>

        <div class="flashcard">
            <div class="question">Was gibt `range(5)` zur√ºck? (Textantwort)</div>
            <div class="answer">Ein Objekt, das eine Sequenz von Zahlen von 0 bis 4 repr√§sentiert.</div>
        </div>

    </div>

    <div class="chapter-container" data-chapter-name="Funktionen">
    
        <div class="flashcard">
            <div class="question">Schreiben Sie eine Funktion <code>get_first_index_negative(A)</code>, die als Parameter eine Liste <code>A</code> √ºbergeben bekommt. Diese Funktion soll den kleinsten Index der Elemente in <code>A</code> zur√ºckgeben, an dem ein Wert kleiner Null steht. Falls nur positive Werte vorkommen, soll die Funktion <code>-1</code> zur√ºckgeben.</div>
            <div class="answer fira-code"><pre><code>def get_first_index_negative(A):
        for i in range(len(A)):
            if A[i] < 0:
                return i
        return -1</code></pre></div>
        </div>
    
        <div class="flashcard">
            <div class="question">Rufen Sie die Funktion <code>get_first_index_negative(A)</code> auf und hinterlegen Sie den R√ºckgabewert in der Variablen <code>i</code>. Geben Sie den Wert des Arrays <code>A</code> an der Stelle <code>i</code> aus. (Gehen Sie davon aus, dass <code>A</code> existiert).</div>
            <div class="answer fira-code"><pre><code># Annahme: A ist eine Liste, z.B. A = [1, 5, 8, -3, 4]
    i = get_first_index_negative(A)
    if i != -1:
        print(A[i])</code></pre></div>
        </div>
    
        <div class="flashcard">
            <div class="question">Je nach Land wird die historische Einheit Pfund mit unterschiedlichen Faktoren in die SI-Einheit Gramm umgerechnet. Implementieren Sie eine Funktion <code>pound2gram(m, factor)</code>, die den Parameter <code>m</code> und einen optionalen Parameter <code>factor</code> √ºbergeben bekommt. <code>m</code> ist eine Masse in Pfund. Der optionale Parameter soll den Defaultwert <code>453.592</code> haben, was der Umrechnung des modernen US Pfund in Gramm entspricht. Die Umrechnung soll anhand der Formel m<sub>gram</sub> = m<sub>pound</sub> ‚ãÖ factor erfolgen. Die Funktion soll die Masse in Gramm zur√ºckgeben.</div>
            <div class="answer fira-code"><pre><code>def pound2gram(m, factor=453.592):
        return m * factor</code></pre></div>
        </div>
    
        <div class="flashcard">
            <div class="question">Rufen Sie die Funktion <code>pound2gram(m)</code> mit der Variablen <code>mypounds</code> als Argument auf und weisen Sie den R√ºckgabewert der Variablen <code>mygrams</code> zu. (Gehen Sie davon aus, dass <code>mypounds</code> existiert).</div>
            <div class="answer fira-code"><pre><code># Annahme: mypounds ist eine Zahl, z.B. mypounds = 2.5
    mygrams = pound2gram(mypounds)</code></pre></div>
        </div>
    
        <div class="flashcard">
            <div class="question">Im Folgenden sind einige Umrechnungsfaktoren f√ºr einige historische Pfunde angegeben: 500 <sup>Gramm</sup>‚ÅÑ<sub>badisches Pfund</sub>, 373.24 <sup>Gramm</sup>‚ÅÑ<sub>Troy Pound</sub>, 1000 <sup>Gramm</sup>‚ÅÑ<sub>Dutch Pond</sub>. Rufen Sie die Funktion <code>pound2gram(m, factor)</code> mit allen drei Umrechnungsfaktoren f√ºr die Masse <code>mypounds</code> mit Wert 0.314 auf und legen Sie das Ergebnis in einem Dictionary <code>mygrams</code> mit Keys <code>'badisch'</code>, <code>'troy'</code> und <code>'dutch'</code> ab.</div>
            <div class="answer fira-code"><pre><code>mypounds = 0.314
    factors = {'badisch': 500, 'troy': 373.24, 'dutch': 1000}
    mygrams = {}
    
    for key in factors:
        mygrams[key] = pound2gram(mypounds, factors[key])</code></pre></div>
        </div>
    
        <div class="flashcard">
            <div class="question">a) Schreiben Sie die Funktion <code>quantize_values(value, num_bits, scaling)</code>. Der Parameter <code>num_bits</code> soll hierbei den Default-Wert 8 haben und der Parameter <code>scaling</code> den Default-Wert 1. Die Funktion berechnet folgenden Wert: <code>floor(value * 2**num_bits / scaling)</code> und gibt ihn zur√ºck. Des Weiteren soll sie pr√ºfen, ob der Wert <code>scaling</code> kleiner gleich Null ist. Ist dies der Fall, soll ein <code>ValueError</code> geworfen werden. Gehen Sie davon aus, dass eine Funktion <code>floor</code> gegeben ist (z.B. aus dem <code>math</code>-Modul).</div>
            <div class="answer fira-code"><pre><code>from math import floor
    
    def quantize_values(value, num_bits=8, scaling=1):
        if scaling <= 0:
            raise ValueError("scaling must be greater than zero")
        return floor(value * 2**num_bits / scaling)</code></pre></div>
        </div>
    
        <div class="flashcard">
            <div class="question">b) Rufen Sie die Funktion <code>quantize_values</code> mit dem Wert <code>value=10.1</code> und <code>scaling=100</code> auf und geben Sie den zur√ºckgegebenen Wert aus. Der Parameter <code>num_bits</code> soll auf dem Default-Wert bleiben.</div>
            <div class="answer fira-code"><pre><code>print(quantize_values(10.1, scaling=100))</code></pre></div>
        </div>
    
        <div class="flashcard">
            <div class="question">c) Sie haben folgende rekursive Folge gegeben: a<sub>n</sub> = { a<sup>2</sup><sub>n-1</sub> wenn n > 0; 1.2 sonst }. Schreiben Sie die Funktion <code>rekursive_folge(n)</code>, welche den Wert der rekurisven Folge a<sub>n</sub> zur√ºckgibt. Gehen Sie davon aus, dass der √úbergabeparameter <code>n</code> vom Typ <code>int</code> ist.</div>
            <div class="answer fira-code"><pre><code>def rekursive_folge(n):
        if n > 0:
            return rekursive_folge(n-1)**2
        else:
            return 1.2</code></pre></div>
        </div>
    
        <div class="flashcard">
            <div class="question">d) Schreiben Sie die Funktion <code>list_rek_folge(m)</code>, welche die Ergebnisse der rekurisven Folge a<sub>n</sub> von n = 0 bis n = m in einer Liste zur√ºckgibt. Die Elemente der Liste sollen folgenderma√üen angeordnet sein: a<sub>0</sub>, a<sub>1</sub>, ..., a<sub>m</sub>. Gehen Sie davon aus, dass Ihnen die Funktion <code>rekursive_folge</code> aus der letzten Teilaufgabe zur Verf√ºgung steht und der √úbergabeparameter <code>m</code> vom Typ <code>int</code> ist.</div>
            <div class="answer fira-code"><pre><code>def list_rek_folge(m):
        result = []
        for i in range(m + 1):
            result.append(rekursive_folge(i))
        return result</code></pre></div>
        </div>
    
    </div>
    
    <!-- KOPIER-VORLAGE F√úR NEUES KAPITEL:
    <div class="chapter-container" data-chapter-name="Dein neuer Kapitelname">
        <div class="flashcard">
            <div class="question">Deine erste Frage hier...</div>
            <div class="answer fira-code">Deine erste Antwort hier...</div>
        </div>
    </div>
    -->

    <!-- =================================================================== -->
</div>


    <!-- Sidebar (wird von JS bef√ºllt) -->
    <aside class="w-full md:w-1/4 lg:w-1/5 bg-gray-800 h-auto md:h-full flex flex-col border-r border-gray-700">
        <div class="p-4 border-b border-gray-700">
            <h1 class="text-xl font-bold">Meine Lernkarten</h1>
        </div>
        <div class="flex-grow overflow-y-auto p-2">
            <h2 class="text-lg font-semibold p-2 text-gray-300">Kapitel</h2>
            <ul id="chapterList">
                <!-- Kapitel werden hier von JavaScript eingef√ºgt -->
            </ul>
        </div>
    </aside>

    <!-- Main Content (wird von JS gesteuert) -->
    <main class="w-full md:w-3/4 lg:w-4/5 h-full flex flex-col p-4 sm:p-6 lg:p-8">
        <h2 id="main-header" class="text-2xl font-bold text-gray-200 mb-4">W√§hle ein Kapitel</h2>
        
        <div id="card-display-area" class="flex-grow bg-gray-800 rounded-lg p-6 flex items-center justify-center relative">
            
            <!-- Startansicht -->
            <div id="welcome-view" class="text-center">
                <h3 class="text-xl text-gray-400">Willkommen!</h3>
                <p class="text-gray-500 mt-2">W√§hle links ein Kapitel aus, um zu beginnen.</p>
            </div>

            <!-- Ansicht f√ºr leere Kapitel -->
            <div id="no-cards-view" class="text-center hidden">
                <h3 class="text-xl text-gray-400">Dieses Kapitel ist leer.</h3>
                <p class="text-gray-500 mt-2">F√ºge Karten in der HTML-Datei hinzu, um hier zu lernen.</p>
            </div>

            <!-- Kapitel abgeschlossen Ansicht -->
            <div id="chapter-complete-view" class="text-center hidden">
                <h3 class="text-2xl font-bold text-green-400">üéâ Kapitel abgeschlossen!</h3>
                <button id="restart-chapter-btn" class="mt-6 px-5 py-2 bg-indigo-600 hover:bg-indigo-500 rounded-md transition-colors duration-200">Nochmal starten</button>
            </div>

            <!-- Die eigentliche Karteikarten-Ansicht -->
            <div id="card-view" class="w-full h-full flex flex-col hidden">
                <div class="flex-grow flex flex-col justify-center">
                    <div class="mb-4">
                        <p class="text-sm text-indigo-400 mb-2">AUFGABE</p>
                        <p id="question" class="text-xl md:text-2xl text-gray-200"></p>
                    </div>
                    <div class="my-4">
                         <label for="user-answer-input" class="block text-sm font-medium text-gray-300 mb-1">Deine Antwort</label>
                         <textarea id="user-answer-input" rows="6" placeholder="Schreibe deinen Code oder deine Antwort hier..." class="w-full bg-gray-900 border border-gray-600 rounded-md px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 fira-code"></textarea>
                    </div>
                    <button id="check-answer-btn" class="my-2 self-center px-6 py-2 bg-blue-600 hover:bg-blue-500 rounded-md transition-colors duration-200 font-semibold">Pr√ºfen</button>
                    <div id="feedback-section" class="hidden mt-4">
                        <div id="feedback-message" class="text-center font-bold p-3 rounded-md mb-4"></div>
                        <p class="text-sm text-green-400 mb-2">KORREKTE L√ñSUNG</p>
                        <pre class="bg-gray-900 rounded-md p-4 w-full overflow-x-auto"><code id="answer" class="fira-code text-base text-gray-300"></code></pre>
                        <div class="text-center mt-4 space-x-4">
                             <button id="know-it-anyway-btn" class="hidden px-4 py-2 bg-yellow-600 hover:bg-yellow-500 text-sm rounded-md transition-colors duration-200">Als richtig werten</button>
                             <button id="try-next-card-btn" class="hidden px-4 py-2 bg-gray-600 hover:bg-gray-500 text-sm rounded-md transition-colors duration-200">N√§chste versuchen</button>
                        </div>
                    </div>
                </div>
                <div class="flex-shrink-0 flex justify-center items-center mt-6">
                    <span id="card-counter" class="text-gray-400"></span>
                </div>
            </div>
        </div>
    </main>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- Zustand der App ---
        let chapters = [];
        let currentChapterIndex = -1;
        let currentCard = null;
        let unansweredCardIndices = [];

        // --- DOM-Elemente ---
        const chapterListEl = document.getElementById('chapterList');
        const mainHeaderEl = document.getElementById('main-header');
        
        const welcomeView = document.getElementById('welcome-view');
        const noCardsView = document.getElementById('no-cards-view');
        const chapterCompleteView = document.getElementById('chapter-complete-view');
        const cardView = document.getElementById('card-view');
        
        const questionEl = document.getElementById('question');
        const userAnswerInput = document.getElementById('user-answer-input');
        const checkAnswerBtn = document.getElementById('check-answer-btn');
        const cardCounterEl = document.getElementById('card-counter');
        
        const feedbackSection = document.getElementById('feedback-section');
        const feedbackMessage = document.getElementById('feedback-message');
        const answerEl = document.getElementById('answer');
        const knowItAnywayBtn = document.getElementById('know-it-anyway-btn');
        const tryNextCardBtn = document.getElementById('try-next-card-btn');
        const restartChapterBtn = document.getElementById('restart-chapter-btn');

        // --- 1. Daten aus dem DOM auslesen ---
        function parseDataFromDOM() {
            const chapterNodes = document.querySelectorAll('#data-storage .chapter-container');
            chapterNodes.forEach(chapterNode => {
                const chapterName = chapterNode.dataset.chapterName || 'Unbenanntes Kapitel';
                const cards = [];
                const cardNodes = chapterNode.querySelectorAll('.flashcard');
                cardNodes.forEach(cardNode => {
                    const question = cardNode.querySelector('.question')?.innerHTML || 'Keine Frage gefunden';
                    // Wichtig: Wir brauchen den reinen Text f√ºr den Vergleich
                    const answerHTML = cardNode.querySelector('.answer')?.innerHTML || 'Keine Antwort gefunden';
                    const answerText = cardNode.querySelector('.answer')?.textContent || 'Keine Antwort gefunden';
                    cards.push({ question, answerHTML, answerText });
                });
                chapters.push({ name: chapterName, cards });
            });
        }

        // --- 2. UI aufbauen ---
        function renderChapterList() {
            chapterListEl.innerHTML = '';
            chapters.forEach((chapter, index) => {
                const li = document.createElement('li');
                const isActive = index === currentChapterIndex;
                li.innerHTML = `<a href="#" data-index="${index}" class="chapter-item block px-4 py-3 rounded-md transition-colors duration-200 ${isActive ? 'bg-indigo-600 text-white' : 'text-gray-300 hover:bg-gray-700'}"><span class="truncate">${chapter.name}</span></a>`;
                chapterListEl.appendChild(li);
            });
        }
        
        function updateMainView() {
            welcomeView.classList.add('hidden');
            noCardsView.classList.add('hidden');
            chapterCompleteView.classList.add('hidden');
            cardView.classList.add('hidden');

            if (currentChapterIndex === -1) {
                mainHeaderEl.textContent = 'W√§hle ein Kapitel';
                welcomeView.classList.remove('hidden');
                return;
            }
            
            const chapter = chapters[currentChapterIndex];
            mainHeaderEl.textContent = chapter.name;

            if (chapter.cards.length === 0) {
                noCardsView.classList.remove('hidden');
            } else if (unansweredCardIndices.length === 0) {
                chapterCompleteView.classList.remove('hidden');
            } else {
                cardView.classList.remove('hidden');
            }
        }

        // --- 3. Lernlogik ---
        function startChapter(chapterIndex) {
            currentChapterIndex = chapterIndex;
            const chapter = chapters[chapterIndex];
            unansweredCardIndices = Array.from(Array(chapter.cards.length).keys()); // [0, 1, 2, ...]
            
            renderChapterList();
            showNextRandomCard();
        }

        function showNextRandomCard() {
            if (unansweredCardIndices.length === 0) {
                updateMainView();
                return;
            }

            const randomIndexInPool = Math.floor(Math.random() * unansweredCardIndices.length);
            const cardIndex = unansweredCardIndices[randomIndexInPool];
            currentCard = { ...chapters[currentChapterIndex].cards[cardIndex], originalIndex: cardIndex };

            displayCard(currentCard);
            updateMainView();
        }

        function displayCard(card) {
            questionEl.innerHTML = card.question;
            answerEl.innerHTML = card.answerHTML; // Setzt das HTML f√ºr die Anzeige
            
            const totalCards = chapters[currentChapterIndex].cards.length;
            cardCounterEl.textContent = `Verbleibend: ${unansweredCardIndices.length} / ${totalCards}`;
            
            userAnswerInput.value = '';
            userAnswerInput.focus();
            feedbackSection.classList.add('hidden');
            knowItAnywayBtn.classList.add('hidden');
            tryNextCardBtn.classList.add('hidden');
        }

        function checkAnswer() {
            if (!currentCard) return;
            const normalize = (str) => str.replace(/\s+/g, ' ').trim();
            const userAnswer = normalize(userAnswerInput.value);
            const correctAnswer = normalize(currentCard.answerText);

            feedbackSection.classList.remove('hidden');
            
            if (userAnswer === correctAnswer) {
                feedbackMessage.textContent = 'Richtig!';
                feedbackMessage.className = 'text-center font-bold p-3 rounded-md mb-4 bg-green-500/20 text-green-400';
                setTimeout(handleCorrectAnswer, 1200);
            } else {
                feedbackMessage.textContent = 'Falsch. Sieh dir die L√∂sung an.';
                feedbackMessage.className = 'text-center font-bold p-3 rounded-md mb-4 bg-red-500/20 text-red-400';
                knowItAnywayBtn.classList.remove('hidden');
                tryNextCardBtn.classList.remove('hidden');
            }
        }

        function handleCorrectAnswer() {
            if (!currentCard) return;
            // Entferne die Karte aus dem Pool der unbeantworteten Karten
            unansweredCardIndices = unansweredCardIndices.filter(index => index !== currentCard.originalIndex);
            showNextRandomCard();
        }

        // --- 4. Event-Handler ---
        chapterListEl.addEventListener('click', (e) => {
            const chapterItem = e.target.closest('.chapter-item');
            if (chapterItem) {
                e.preventDefault();
                startChapter(parseInt(chapterItem.dataset.index, 10));
            }
        });

        checkAnswerBtn.addEventListener('click', checkAnswer);
        userAnswerInput.addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                checkAnswer();
            }
        });

        knowItAnywayBtn.addEventListener('click', handleCorrectAnswer);
        tryNextCardBtn.addEventListener('click', showNextRandomCard);
        restartChapterBtn.addEventListener('click', () => {
            if (currentChapterIndex !== -1) {
                startChapter(currentChapterIndex);
            }
        });

        // --- App starten ---
        function main() {
            parseDataFromDOM();
            renderChapterList();
            updateMainView();
        }

        main();
    });
    </script>
</body>
</html>
